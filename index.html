<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
  <title>Letter for Abby</title>
  <style>
    :root{
      --bg1:#ffefd5;
      --bg2:#ffd6e7;
      --accent:#ff5e84;
      --paper:#fffdf8;
      --text:#333;
      --heart-size:220px;
      --heart-mobile:160px;
    }
    *{box-sizing:border-box}
    html,body{height:100%;}
    body{
      margin:0;
      font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
      /* layered background: base gradient + soft bokeh highlights */
      background:
        radial-gradient(800px 400px at 10% 10%, rgba(255,120,160,0.10), transparent 12%),
        radial-gradient(600px 320px at 90% 80%, rgba(255,200,180,0.06), transparent 10%),
        linear-gradient(135deg,var(--bg1),var(--bg2));
      background-repeat:no-repeat;
      background-attachment:fixed;
      display:flex;
      align-items:center;
      justify-content:center;
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      position:relative;
      overflow-x:hidden;
    }

    /* soft overlay and subtle diagonal texture */
    body::before{
      content:'';
      position:fixed;
      inset:0;
      pointer-events:none;
      z-index:0;
      background-image:
        repeating-linear-gradient(135deg, rgba(255,255,255,0.02) 0 2px, rgba(255,255,255,0) 2px 10px),
        radial-gradient(circle at 30% 20%, rgba(255,255,255,0.06), transparent 8%),
        radial-gradient(circle at 80% 80%, rgba(255,235,240,0.045), transparent 10%);
      mix-blend-mode: soft-light;
      opacity:1;
    }

    /* decorative floating ornaments (hearts + dots) */
    .bg-ornaments{position:fixed;inset:0;pointer-events:none;z-index:0;overflow:hidden;transition:transform .6s cubic-bezier(.2,.9,.2,1);will-change:transform}
    .bg-ornaments .orb{
      position:absolute;
      left:50%;top:50%;
      transform:translate(-50%,-50%);
      width:var(--w,180px);height:var(--h,180px);
      display:flex;align-items:center;justify-content:center;
      /* lower overall ornament opacity for a more subtle look */
      opacity:var(--orb-opacity,0.42); color:var(--c,#ff5e84);
      transition:opacity .3s ease;
    }
    .bg-ornaments .orb svg{width:60%;height:60%;display:block;fill:currentColor;filter:drop-shadow(0 6px 18px rgba(255,94,132,.08));}

    /* soft glow behind each orb */
    .bg-ornaments .orb::after{
      content:'';position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);
      width:140%;height:140%;border-radius:50%;z-index:-1;opacity:var(--orb-glow,0.34);
      background:radial-gradient(circle at center, currentColor 0%, transparent 40%);
      filter:blur(var(--blur,18px));
      transition:opacity .3s ease, filter .3s ease;
    }

    /* color tokens */
    .bg-ornaments .orb[data-color='1']{--c:#ff5e84}
    .bg-ornaments .orb[data-color='2']{--c:#ffd1e0}
    .bg-ornaments .orb[data-color='3']{--c:#ff9ab8}
    .bg-ornaments .orb[data-color='4']{--c:#ffd6a5}

    /* gentle beat for hearts */
    @keyframes beat{0%{transform:translate(-50%,-50%) scale(.98)}50%{transform:translate(-50%,-50%) scale(1.06)}100%{transform:translate(-50%,-50%) scale(.98)}}

    /* drifting path */
    @keyframes driftPath{0%{transform:translate(-50%,-50%) translate(0,0) rotate(0deg)}25%{transform:translate(-50%,-40%) translate(8px,-6px) rotate(-2deg)}50%{transform:translate(-50%,-50%) translate(0,12px) rotate(0deg)}75%{transform:translate(-50%,-60%) translate(-6px,6px) rotate(2deg)}100%{transform:translate(-50%,-50%) translate(0,0) rotate(0deg)}}

    .bg-ornaments .orb.heart{animation: driftPath var(--d,10s) ease-in-out infinite, beat calc(var(--d,10s)/3) ease-in-out infinite;}
    .bg-ornaments .orb.dot{border-radius:50%;background:radial-gradient(circle at center, currentColor 0%, transparent 40%);filter:blur(28px);animation: driftPath var(--d,12s) ease-in-out infinite}

    /* make very large/oval shapes respect custom radius */
    .bg-ornaments .orb[style*='--r']{border-radius:var(--r)}

    /* subtle reduce on small screens */
    @media (max-width:480px){
      .bg-ornaments .orb{opacity:.85}
      .bg-ornaments .orb svg{width:70%}
      .bg-ornaments .orb::after{opacity:.55}
    }

    /* floating hearts (infinite upward balloons) ðŸ”§ */
    .floating-hearts{position:absolute;inset:0;pointer-events:none;z-index:0;overflow:visible}
    .floating-heart{position:absolute;left:var(--left,50%);bottom:-8%;width:var(--size,40px);height:var(--size,40px);pointer-events:none;display:block;animation:floatUp var(--duration,8s) linear var(--delay,0s) forwards;will-change:transform,opacity}
    .floating-heart .shape{width:100%;height:100%;display:block;transform-origin:center center;animation:sway var(--sway-duration,3s) ease-in-out infinite}
    .floating-heart svg{width:100%;height:100%;display:block;fill:currentColor;filter:drop-shadow(0 8px 20px rgba(0,0,0,.06));}
    @keyframes floatUp{0%{transform:translateY(0);opacity:0}5%{opacity:1}100%{transform:translateY(-130vh);opacity:0}}
    @keyframes sway{0%{transform:translateX(0) rotate(-6deg)}50%{transform:translateX(var(--sway,18px)) rotate(6deg)}100%{transform:translateX(0) rotate(-4deg)}}

    .floating-heart[data-hidden='1']{opacity:0;pointer-events:none;transition:opacity .3s}

    .stage{
      width:100%;
      max-width:760px;
      padding:40px;
      text-align:center;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      min-height:calc(100vh - 40px);
      position:relative;
      z-index:1;
    }

    h1{margin:0 0 18px;font-size:28px;letter-spacing:0.2px}
    .subtitle{margin-bottom:20px;color:#7a5a6d}

    /* Heart */
    .heart-wrap{position:relative;min-height:260px;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:30px 0;width:100%}
    .heart{width:var(--heart-size);height:var(--heart-size);cursor:pointer;transform-origin:center center;transition:transform .35s ease;z-index:5} 
    .heart svg{width:100%;height:100%;display:block}
    .pulse{animation:pulse 1.2s infinite}
    @keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.06)}100%{transform:scale(1)}}

    /* burst particles */
    .particle{position:absolute;width:8px;height:8px;border-radius:50%;background:var(--accent);opacity:0;pointer-events:none}
    #particles{position:fixed;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:3} 

/* Papers (replacing envelope) */
    @media (max-width:480px){
      .heart{width:var(--heart-mobile);height:var(--heart-mobile)}
      .envelope{width:260px;height:170px}
    }
    .paper-wrap{position:relative;height:360px;display:flex;align-items:center;justify-content:center;display:none;opacity:0;transition:opacity .28s ease}
    .paper-card{width:340px;min-height:240px;background:linear-gradient(180deg,#fffefc,#fff7f1);border-radius:12px;box-shadow:0 22px 48px rgba(0,0,0,.18);position:relative;transform:rotate(-1deg);cursor:pointer;transition:transform .28s cubic-bezier(.2,.9,.2,1);overflow:hidden}
    .paper-card:active{transform:translateY(4px) rotate(-1deg)}

    .page{padding:26px 24px;min-height:220px;display:flex;flex-direction:column;justify-content:center}
    .page-inner{position:relative}
    .page-text{font-family:'Playfair Display', serif;font-size:18px;line-height:1.75;color:#2a2a2a;white-space:pre-wrap;padding-right:8px;padding-left:8px;margin:0} 
    .page-footer{position:absolute;right:8px;bottom:8px;font-size:12px;color:#9a7a87}

    .nav-hint{position:absolute;top:50%;transform:translateY(-50%);font-size:22px;color:rgba(0,0,0,.12);width:48px;height:48px;display:flex;align-items:center;justify-content:center;pointer-events:auto;cursor:pointer;user-select:none}
    .nav-hint.left{left:-64px}
    .nav-hint.right{right:-64px}
    .page-counter{position:absolute;right:6px;bottom:-28px;font-size:13px;color:#a37b86}

    .paper-stack{position:absolute;left:10px;top:12px;width:300px;height:210px;transform:rotate(-2deg);border-radius:9px;background:linear-gradient(180deg,#fff9f7,#fff2ee);box-shadow:0 6px 14px rgba(0,0,0,.06);opacity:.6;z-index:0}

    .page.turning{animation:turn .36s ease both}
    @keyframes turn{0%{transform:translateX(0) rotateY(0)}50%{transform:translateX(-40px) rotateY(-16deg)}100%{transform:translateX(-100%) rotateY(-36deg)}}
    .page.incoming{animation:incoming .36s ease both}
    @keyframes incoming{0%{transform:translateX(100%) rotateY(36deg)}50%{transform:translateX(40px) rotateY(16deg)}100%{transform:translateX(0) rotateY(0)}}

    .page-count{display:block;margin-top:12px;font-size:13px;color:#a37b86;text-align:right}

    .controls{margin-top:22px}
    .btn{background:var(--accent);color:#fff;padding:10px 16px;border-radius:8px;border:0;cursor:pointer;font-weight:600}
    .btn.secondary{background:transparent;color:var(--accent);border:2px solid rgba(255,94,132,.1)}

    /* utilities */
    .hide{display:none}

    /* small screen tweaks */
    @media (max-width:480px){
      .heart{width:120px;height:120px}
      .envelope{width:260px;height:170px}
    }


  </style>
</head>
<body>
  <div class="bg-ornaments" aria-hidden="true">
    <span class="orb heart" data-color="1" style="left:8%;top:18%;--d:8s;--w:180px;--h:180px;">
      <svg viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
    </span>
    <span class="orb heart" data-color="2" style="right:10%;top:26%;--d:11s;--w:220px;--h:220px;">
      <svg viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
    </span>
    <span class="orb heart" data-color="3" style="left:78%;top:72%;--d:9s;--w:160px;--h:160px;">
      <svg viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
    </span>
    <span class="orb heart" data-color="4" style="left:42%;top:88%;--d:13s;--w:260px;--h:120px;--r:60%;">
      <svg viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
    </span>
    <span class="orb dot" data-color="1" style="left:62%;top:12%;--d:14s;--w:88px;--h:88px;"></span>
    <span class="orb dot" data-color="2" style="left:22%;top:80%;--d:10s;--w:100px;--h:100px;"></span>
    <div class="floating-hearts" aria-hidden="true"></div>
  </div>
  <main class="stage">
    <h1>For the Girl Who Changed My YearðŸ’Œ</h1>
    <p class="subtitle">Click the heart at the center to reveal a special love letter!</p>

    <div class="heart-wrap">
      <!-- Cartoon heart as SVG -->
      <div id="heart" class="heart pulse" title="Click to open the letter" role="button" aria-pressed="false" tabindex="0">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <defs>
            <filter id="shadow" x="-50%" y="-50%" width="200%" height="200%">
              <feDropShadow dx="0" dy="6" stdDeviation="8" flood-color="#ff7a98" flood-opacity=".18"/>
            </filter>
            <linearGradient id="grad" x1="0" x2="1">
              <stop offset="0%" stop-color="#ff7393"/>
              <stop offset="100%" stop-color="#ff3f6e"/>
            </linearGradient>
          </defs>
          <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" fill="url(#grad)" filter="url(#shadow)"/>
        </svg>
      </div>
      <!-- particles area -->
      <div id="particles"></div>

<!-- Papers (hidden initially) -->
      <div id="paperWrap" class="paper-wrap" aria-hidden="true">
        <div id="paperCard" class="paper-card" role="button" tabindex="0" aria-label="Paper. Click right side to go forward, left side to go back">
          <div class="paper-stack" aria-hidden="true"></div>
          <div class="page">
            <div class="page-inner">
              <div class="page-text"></div>
            </div>
          </div>
        </div>
        <div id="prevBtn" class="nav-hint left" role="button" aria-label="Previous page">â—€</div>
        <div id="nextBtn" class="nav-hint right" role="button" aria-label="Next page">â–¶</div>
        <div class="page-counter">Page <span id="pageNum">1</span>/<span id="pageCount">3</span></div>
      </div>

    </div>

    <div class="controls">
      <button id="resetBtn" class="btn secondary hide">Reset</button>
    </div>


  </main>

  <script>
    const heart = document.getElementById('heart');
    const particles = document.getElementById('particles');
    const resetBtn = document.getElementById('resetBtn');

    function createParticles(x,y){
      const colors = ['#ff5e84','#ffd1e0','#ff9ab8','#ffd6a5'];
      const count = 20;
      for(let i=0;i<count;i++){
        const el = document.createElement('div');
        el.className='particle';
        el.style.left=(x-4)+'px';
        el.style.top=(y-4)+'px';
        el.style.background = colors[Math.floor(Math.random()*colors.length)];
        particles.appendChild(el);
        // random trajectory
        const angle = Math.random()*Math.PI*2;
        const dist = 60 + Math.random()*90;
        const destX = Math.cos(angle)*dist;
        const destY = Math.sin(angle)*dist - 20;
        el.animate([
          {transform:'translate(0,0) scale(1)', opacity:1},
          {transform:`translate(${destX}px, ${destY}px) scale(.6)`, opacity:0}
        ],{duration:700+Math.random()*400, easing:'cubic-bezier(.2,.9,.2,1)'});
        setTimeout(()=>el.remove(),1200);
      }
    }

    function getCenter(el){
      const r = el.getBoundingClientRect();
      return {x:r.left + r.width/2, y:r.top + r.height/2};
    }

    // paper pagination setup
    const paperWrap = document.getElementById('paperWrap');
    const paperCard = document.getElementById('paperCard');
    const pageText = document.querySelector('.page-text');
    const pageNumSpan = document.getElementById('pageNum');
    const pageCountSpan = document.getElementById('pageCount');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    if(prevBtn){
      prevBtn.addEventListener('click',(e)=>{ e.stopPropagation(); prevPage(); });
      prevBtn.tabIndex = 0;
      prevBtn.addEventListener('keydown',(e)=>{ if(e.key==='Enter' || e.key===' ') { prevPage(); e.preventDefault(); } });
    }
    if(nextBtn){
      nextBtn.addEventListener('click',(e)=>{ e.stopPropagation(); nextPage(); });
      nextBtn.tabIndex = 0;
      nextBtn.addEventListener('keydown',(e)=>{ if(e.key==='Enter' || e.key===' ') { nextPage(); e.preventDefault(); } });
    }

    const pages = [
      "Dear Abby,\n\nI hope this letter finds you well. I just wanted to say that I'm very thankful for all the moments we've shared.",
      "The support you give, the love na lagi mo binibigay, and yung paraan na lagi mo akong pinapaniwalaan kahit minsan hindi ko nararamdaman na kaya ko.",
      "Sobrang laki kaya ng impact nun sa akin and minsan napapaisip nalang ako kung paano ako naging this lucky na makilala ka and paano ka naging ganun ka malaking parte ng buhay ko sa loob ng isang taon.",
      "Lately, napapansin ko rin sa sarili ko na nagiging mas aware ako sa mga ginagawa at sinasabi ko. Lalo na pagdating sayo, naiisip ko lagi kung paano kita mas mapapasaya, paano kita mapaparamdam na mahalaga ka and make you feel exactly na you're safe with me.",
      "Natututo rin ako maging mas patient, mas understanding, at mas maingat sa mga bagay na pwedeng makasakit sayo kahit hindi ko sinasadya. Hindi man ako perfect, pero gusto kong malaman mo na bawat araw sinisikap kong ipakita sayo kung gaano ka kahalaga at kung gaano ko pinapahalagahan lahat ng pagmamahal na binibigay mo sakin.",
      "Isang taon na rin pala tayong magkakilala, time really flies so fast. Isang taon ng tawanan, kwentuhan, tsaka mga simpleng moments na ngayon sobrang priceless na para sa akin.",
      "Lahat ng inside jokes natin, yung mga simpleng hirit, yung mga minsan mahihirap na moments rin pero nagagawa pa rin natin tumawa. It's one of the things I always cherish the most.",
      "Sobrang thankful ako na nandiyan ka sa tabi ko sa lahat ng highs and lows ko. Every time na makausap kita or marinig lang kita, ang saya ko na agad. Maybe you're not aware of it pero ang liwanag na ng buhay ko simula nung dumating ka and I also want you to feel na ganun ka rin kahalaga sa akin.",
      "Thank you. Sa pagtitiis sa mga panahong mahirap intindihin ang mood ko, at sa love na binibigay mo kahit hindi ko laging nasasabi.",
      "Sobrang appreciate ko lahat ng ginagawa mo, lahat ng effort mo, at yung love mo na walang kondisyon. Minsan, kapag naiisip ko yung mga bagay na ginawa mo para sa akin, hindi ko maiwasan na ma-smile at ma-feel randomly like sobrang lucky ko talaga.",
      "Alam mo, excited talaga ako sa mga darating na araw at sa mga mangyayari. Ang dami nating pwedeng ma-experience. mga simpleng bagay man o mga unexpected na moments talaga.",
      "Yung tipong kahit ordinary lang yung araw, may mga bagay pa rin tayong mapapangiti o mapapasaya sa isaâ€™t isa, sobrang satisfying kaya ng ganung moments.",
      "Maraming bagay pwede nating paghandaan and abangan sa future. Kahit maliit o simple man na bagay mangyari, mas magiging memorable siya kapag ramdam mo na special yung bawat moment.",
      "At sa dami non, hindi ko rin mapigilan sarili ko on being curious and excited sa lahat ng ma-discover natin habang nageenjoy lang sa bawat sandali.",
      "Take care always noh, and Happy New Year! Even though malapit na rin matapos S.Y. sana ngayong taon mas marami pa tayong moments na ma-share sa isa't isa.",
      "Yung mga tawanan, kwentuhan, pag-tulungan and most of all loving memories na pwede nating alalahanin buong buhay.",
      "Sincerely,\nJoey"
    ];
    let currentPage = 0;

    function fitTextToBox(){
      const inner = document.querySelector('.page-inner');
      let fs = 18; // starting font-size
      const min = 14; // minimum font-size to avoid unreadably small text
      pageText.style.fontSize = fs + 'px';
      // attempt to reduce font size until content fits
      for(let i=0;i<20;i++){
        if(pageText.scrollHeight <= inner.clientHeight || fs <= min) break;
        fs -= 0.5;
        pageText.style.fontSize = fs + 'px';
      }
    }

    function renderPage(index, direction='forward'){
      index = Math.max(0, Math.min(pages.length-1, index));
      const pageEl = document.querySelector('.page');
      pageEl.classList.remove('incoming','turning');
      // trigger reflow for animation
      void pageEl.offsetWidth;
      if(direction==='forward') pageEl.classList.add('turning'); else pageEl.classList.add('incoming');
      setTimeout(()=>{
        pageText.textContent = pages[index];
        pageNumSpan.textContent = index+1;
        pageCountSpan.textContent = pages.length;
        // ensure paragraph fits (scale down if needed)
        fitTextToBox();
        pageEl.classList.remove('incoming','turning');
      }, 200);
    }

    function showPapers(){
      paperWrap.style.display='flex';
      requestAnimationFrame(()=> paperWrap.style.opacity='1');
      paperCard.style.transform='translateY(10px) rotate(-1deg) scale(.98)';
      setTimeout(()=> paperCard.style.transform='translateY(0) rotate(-1deg) scale(1)',60);
      // show reset quickly
      setTimeout(()=> resetBtn.classList.remove('hide'),400);
      currentPage = 0;
      renderPage(currentPage);
    }

    function nextPage(){ if(currentPage < pages.length-1){ currentPage++; renderPage(currentPage,'forward'); } }
    function prevPage(){ if(currentPage > 0){ currentPage--; renderPage(currentPage,'back'); } }

    // click handler: right half = next, left half = prev
    paperCard.addEventListener('click',(e)=>{
      const rect = paperCard.getBoundingClientRect();
      const x = e.clientX - rect.left;
      if(x > rect.width/2) nextPage(); else prevPage();
    });

    paperCard.addEventListener('keydown',(e)=>{
      if(e.key==='ArrowRight' || e.key==='Enter' || e.key===' ') { nextPage(); e.preventDefault(); }
      if(e.key==='ArrowLeft') { prevPage(); e.preventDefault(); }
    });

    function burstAndOpen(){
      heart.classList.remove('pulse');
      // center for particles
      const c = getCenter(heart);
      createParticles(c.x, c.y);
      // small pop animation
      heart.animate([
        {transform:'scale(1)'},
        {transform:'scale(1.25)'},
        {transform:'scale(0)', opacity:0}
      ],{duration:520,easing:'cubic-bezier(.2,.9,.3,1)'});

      setTimeout(()=>{
        heart.style.display='none';
        showPapers();
      },480);
    }

    heart.addEventListener('click',()=>{
      burstAndOpen();
    });

    // support keyboard activation
    heart.tabIndex=0;
    heart.addEventListener('keydown',(e)=>{if(e.key==='Enter' || e.key===' ') burstAndOpen();});

    resetBtn.addEventListener('click',()=>{
      // reset states
      paperWrap.style.opacity='0';
      setTimeout(()=>{ paperWrap.style.display='none'; }, 300);
      heart.style.display='block';
      heart.classList.add('pulse');
      resetBtn.classList.add('hide');

    });



    // floating hearts generator (infinite upward balloons)
    (function(){
      const floatingContainer = document.querySelector('.floating-hearts');
      const heartColors = ['#ff5e84','#ffd1e0','#ff9ab8','#ffd6a5'];
      let heartPool = 0;
      const MAX_HEARTS = 40;
      const prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;

      function createFloatingHeart(){
        if(!floatingContainer || prefersReduced) return;
        if(heartPool >= MAX_HEARTS) return;
        heartPool++;
        const el = document.createElement('span');
        el.className = 'floating-heart';
        const size = Math.round(14 + Math.random()*80);
        const left = Math.round(6 + Math.random()*88) + '%';
        const duration = (6 + Math.random()*12).toFixed(2) + 's';
        const sway = Math.round(6 + Math.random()*32) + 'px';
        const color = heartColors[Math.floor(Math.random()*heartColors.length)];
        const delay = (Math.random()*1.2).toFixed(2) + 's';
        const scale = (0.8 + Math.random()*0.7).toFixed(2);
        const rot = Math.round(-30 + Math.random()*60) + 'deg';

        el.style.setProperty('--size', size+'px');
        el.style.setProperty('--left', left);
        el.style.setProperty('--duration', duration);
        el.style.setProperty('--sway', sway);
        el.style.setProperty('--sway-duration', (parseFloat(duration) * 0.33).toFixed(2) + 's');
        el.style.setProperty('--c', color);
        el.style.setProperty('--delay', delay);
        el.style.setProperty('--scale', scale);
        el.style.setProperty('--rot', rot);
        el.setAttribute('data-hidden','0');

        el.innerHTML = '<span class="shape" style="color:'+color+'"><svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" fill="currentColor"/></svg></span>';

        floatingContainer.appendChild(el);

        const cleanup = () => { el.removeEventListener('animationend', cleanup); if(el.parentNode){ el.parentNode.removeChild(el); } heartPool--; };
        el.addEventListener('animationend', cleanup);

        // safety remove after max duration
        setTimeout(()=>{ if(el.parentNode) el.parentNode.removeChild(el); if(heartPool>0) heartPool--; }, (parseFloat(duration)*1000)+3000);
      }

      let spawnTimer = null;
      function startHearts(){ if(prefersReduced) return; if(spawnTimer) return; spawnTimer = setInterval(()=>{ createFloatingHeart(); }, 520); }
      function stopHearts(){ if(!spawnTimer) return; clearInterval(spawnTimer); spawnTimer = null; }

      // start & seed initial hearts
      startHearts();
      for(let i=0;i<6;i++){ setTimeout(createFloatingHeart, i*300); }

      document.addEventListener('visibilitychange', ()=>{ if(document.hidden) stopHearts(); else startHearts(); });

    })();

    // ornaments: parallax and variance
    (function(){
      const ornaments = document.querySelector('.bg-ornaments');
      if(!ornaments) return;
      let cx = window.innerWidth/2, cy = window.innerHeight/2;
      let raf = null;
      let targetX = 0, targetY = 0, currentX = 0, currentY = 0;
      function onMove(e){
        const x = (e.clientX - cx);
        const y = (e.clientY - cy);
        targetX = (x / cx) * 12;
        targetY = (y / cy) * -10;
        if(!raf) raf = requestAnimationFrame(update);
      }
      function update(){
        currentX += (targetX - currentX) * 0.08;
        currentY += (targetY - currentY) * 0.08;
        ornaments.style.transform = `translate(${currentX}px, ${currentY}px)`;
        raf = null;
      }
      window.addEventListener('mousemove', onMove);
      window.addEventListener('resize', ()=>{cx = window.innerWidth/2; cy = window.innerHeight/2});
      window.addEventListener('mouseleave', ()=>{targetX = 0; targetY = 0});

      // randomize delays and brightness a bit
      document.querySelectorAll('.bg-ornaments .orb').forEach((o,i)=>{
        const d = o.style.getPropertyValue('--d') || (8 + Math.random()*8)+'s';
        o.style.setProperty('--d', d);
        const delay = (Math.random()*2).toFixed(2)+'s';
        o.style.animationDelay = delay;
        o.style.setProperty('--blur', (6 + Math.random()*20)+'px');
        // slight size variance
        const w = o.style.getPropertyValue('--w') || (140 + Math.random()*140)+'px';
        const h = o.style.getPropertyValue('--h') || (140 + Math.random()*120)+'px';
        o.style.width = w; o.style.height = h;
      });
    })();

  </script>
</body>

</html>


